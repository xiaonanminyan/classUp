$(function(){function s(s){var e={};if(-1!=s.indexOf("?")){var a=s.split("?")[1];if(-1==a.indexOf("&")){var i=a.split("=");e[i[0]]=i[1]}}return e}var e=window.location.href,a={marking:s(e).c,course_type:0,pageIndex:1,flag:"",ex_learned:0,order:2},i={ListPart:function(s){for(var e="",a=0;a<s.length;a++){var i="";1==s[a].is_learned&&s[a].learn_rate<100?i='<div class="shizhan-course-rate">'+s[a].learn_rate+"%</div>":100==s[a].learn_rate&&(i='<div class="shizhan-course-rate imwap-check"></div>'),e+='<dd>                        <a href="'+s[a].share+'" class="clearfix">                            <div class="l pr">                            '+i+'                            <img src="'+s[a].pic+'">                            </div>                            <div class="l course-info">                                <p class="tit">'+s[a].name+'</p>                                <p class="desc">'+s[a].short_description+'</p>                                <p class="info">'+s[a].level+"<em>·</em>"+s[a].numbers+"人在学 </span></p>                            </div>                        </a>                    </dd>"}return e},courselist:function(s){$.ajax({url:"/wap/api/course/loadCourseList",dataType:"json",type:"get",data:s,success:function(e){if(200==e.code)if(console.log(e.data),""==e.data.courselist)$(".js-loading").hide(),$(".js-load-tip").show(),$(".js-load-course").hide(),$(".js-course-list").empty();else if(e.data.courselist.length>0){s.pageIndex=1*s.pageIndex+1;var a=i.ListPart(e.data.courselist);$(".js-loading").hide(),"more"==s.flag?$(".js-course-list").append(a):$(".js-course-list").html(a),e.data.courselist.length>=20?$(".js-load-course").show():($(".js-load-course").hide(),"more"==s.flag&&$(".js-load-tip").show()),s.flag=""}},error:function(){alert("发生错误，请稍后尝试！")}})}};i.courselist(a),$(".js-type-tab a").on("click",function(){a.pageIndex=1,a.course_type=$(this).data("type"),$(".js-course-list").empty(),$(".js-type-tab a").removeClass("cur"),$(this).addClass("cur"),$(".js-load-course").data("type",a.course_type),$(".js-loading").show(),$(".js-type").find("span").text($(this).text()),$(".course-class-box").hide(),$(".js-slide").removeClass("slideshow"),$(".js-load-course").hide(),$(".js-load-tip").hide(),i.courselist(a)}),$(".js-best-tab a").on("click",function(){a.pageIndex=1,a.order=$(this).attr("data-order"),$(".js-best-tab a").removeClass("cur"),$(this).addClass("cur"),$(".js-loading").show(),$(".js-best").find("span").text($(this).text()),$(".course-class-box").hide(),$(".js-slide").removeClass("slideshow"),$(".js-load-course").hide(),$(".js-load-tip").hide(),i.courselist(a)}),$(".js-slide").on("click",function(){var s=$(this).attr("data-type");$(".course-class-box").hide(),$(this).siblings(".js-slide").removeClass("slideshow"),$(this).hasClass("slideshow")?($(this).removeClass("slideshow"),$(".js-"+s+"-tab").hide()):($(this).addClass("slideshow"),$(".js-"+s+"-tab").show())}),$(".js-hide-switch").on("click",function(){a.pageIndex=1,$(this).hasClass("cur")?($(this).removeClass("cur"),a.ex_learned=0):($(this).addClass("cur"),a.ex_learned=1),i.courselist(a)}),$(".js-load-course").on("click",function(){a.flag="more",i.courselist(a)})});